-- MySQL Script generated by MySQL Workbench
-- Wed Oct  2 22:49:00 2019
-- Model: modelo_principal    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema cuci-mobil
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema cuci-mobil
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `cuci-mobil` DEFAULT CHARACTER SET utf8 ;
USE `cuci-mobil` ;

-- -----------------------------------------------------
-- Table `cuci-mobil`.`TIPO_VEHICULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`TIPO_VEHICULO` (
  `ID_TIPO_VEHICULO` INT NOT NULL AUTO_INCREMENT COMMENT 'numero identificable del tipo de vehiculo',
  `NOMBRE` VARCHAR(45) NOT NULL COMMENT 'Nombre del tipo vehiculo',
  `ACTIVO` VARCHAR(1) NOT NULL DEFAULT 'S' COMMENT 'Indicador si el tipo vehiculo esta activo para la utilizacion ',
  PRIMARY KEY (`ID_TIPO_VEHICULO`))
ENGINE = InnoDB
INSERT_METHOD = FIRST
PACK_KEYS = DEFAULT
ROW_FORMAT = DYNAMIC;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`TIPO_ESTADO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`TIPO_ESTADO` (
  `ID_TIPO_ESTADO` INT NOT NULL AUTO_INCREMENT COMMENT 'id del estado',
  `NOMBRE_ESTADO` VARCHAR(45) NOT NULL COMMENT 'nombre del estado',
  PRIMARY KEY (`ID_TIPO_ESTADO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`VEHICULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`VEHICULO` (
  `ID_VEHICULO` INT NOT NULL AUTO_INCREMENT,
  `PLACA` VARCHAR(10) NOT NULL COMMENT 'Almacena la placa del vehiculo ',
  `ACTIVO` VARCHAR(1) NOT NULL DEFAULT 'S' COMMENT 'Indicador si el vehiculo esta activo para procesar con el ',
  `TIPO_VEHICULO_ID_TIPO_VEHICULO` INT NOT NULL COMMENT 'identifica el tipo de vehiculo ',
  `TIPO_ESTADO_ID_TIPO_ESTADO` INT NOT NULL COMMENT 'el id del estado del vehiculo ',
  PRIMARY KEY (`ID_VEHICULO`, `TIPO_VEHICULO_ID_TIPO_VEHICULO`, `TIPO_ESTADO_ID_TIPO_ESTADO`),
  INDEX `fk_VEHICULO_TIPO_VEHICULO1_idx` (`TIPO_VEHICULO_ID_TIPO_VEHICULO` ASC) VISIBLE,
  INDEX `fk_VEHICULO_TIPO_ESTADO1_idx` (`TIPO_ESTADO_ID_TIPO_ESTADO` ASC) VISIBLE,
  CONSTRAINT `fk_VEHICULO_TIPO_VEHICULO1`
    FOREIGN KEY (`TIPO_VEHICULO_ID_TIPO_VEHICULO`)
    REFERENCES `cuci-mobil`.`TIPO_VEHICULO` (`ID_TIPO_VEHICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VEHICULO_TIPO_ESTADO1`
    FOREIGN KEY (`TIPO_ESTADO_ID_TIPO_ESTADO`)
    REFERENCES `cuci-mobil`.`TIPO_ESTADO` (`ID_TIPO_ESTADO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`CLIENTE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`CLIENTE` (
  `ID_CLIENTE` INT NOT NULL AUTO_INCREMENT COMMENT 'IDENTIFICATIVO DEL CLIENTE',
  `NOMBRE` VARCHAR(50) NOT NULL COMMENT 'NOMBRE DEL CLIENTE',
  `APELLIDOS` VARCHAR(45) NOT NULL COMMENT 'APELLIDOS DEL CLIENTE',
  `CEDULA` INT NOT NULL COMMENT 'CEDULA DEL CLIENTE',
  `TELEFONO` VARCHAR(15) NOT NULL COMMENT 'TELEFONO DEL CLIENTE \n',
  `ACTIVO` VARCHAR(1) NOT NULL DEFAULT 'S' COMMENT 'ESTADO DEL CLIENTE S/N',
  PRIMARY KEY (`ID_CLIENTE`),
  UNIQUE INDEX `CEDULA_UNIQUE` (`CEDULA` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`SERVICIOS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`SERVICIOS` (
  `ID_SERVICIO` INT NOT NULL AUTO_INCREMENT COMMENT 'IDENTIFICADOR DEL SERVICIO ',
  `NOMBRE_SERVICIO` VARCHAR(45) NOT NULL COMMENT 'NOMBRE DEL SERVICIO',
  `ACTIVO` VARCHAR(45) NOT NULL DEFAULT 'S' COMMENT 'INDICATIVO DE SI EL SERVICIO ESTA DISPONIBLE ',
  PRIMARY KEY (`ID_SERVICIO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`DESCUENTOS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`DESCUENTOS` (
  `ID_DESCUENTOS` INT NOT NULL COMMENT 'IDENTIFICADOR DEL DESCUENTO ',
  `PORCENTAJE_DESCUENTO` DECIMAL(5,2) NOT NULL COMMENT 'PORSENTAJE DEL DESCUENTO',
  `FECHA_INICIO` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'fecha en la que inicia el descuento',
  `FECHA_FIN` VARCHAR(45) NULL COMMENT 'fecha en que finaliza el descuento ',
  `ACTIVO` VARCHAR(45) NOT NULL DEFAULT 'S' COMMENT 'INDICA SI EL DESCUENTO ESTA ACTIVO PARA LOS NUEVOS PROCESOS S/N',
  PRIMARY KEY (`ID_DESCUENTOS`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`FACTURA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`FACTURA` (
  `ID_FACTURA` INT NOT NULL AUTO_INCREMENT COMMENT 'NUMERO IDENTIFICADOR DE LA FACTURA ',
  `CLIENTE_ID_CLIENTE` INT NULL,
  `TOTAL` VARCHAR(45) NOT NULL COMMENT 'EL PRECIO TOTAL DE TODOS LOS SERVICIOS PRESTADOS AL VEHICULO SIN EL DESCUENTO',
  `TOTAL_NETO` VARCHAR(45) NULL COMMENT 'EL PRECIO TOTAL A PAGAR POR EL CLIENTE YA ESTA APLICADO EL DESCUENTO ',
  `TURNO` VARCHAR(50) NOT NULL COMMENT 'TURNO DEL SERVICIO ESTA COMPUESTA POR FECHA + CONSECUTIVO \nEL CONSECUTIVO SE REINICIA CADA DIA ',
  `FECHA_ENTRADA` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'HORA DE ENTRADA EL VEHICULO A LA SERVITECA',
  `FECHA_SALIDA` TIMESTAMP NULL COMMENT 'HORA DE SALIA DEL VEHICULO DE LA SERVITECA TENIENDO YA LA LIQUIDACION ',
  `ACTIVO` VARCHAR(1) NOT NULL COMMENT 'INDICA SI LA FACTURA ESTA VALIDA ',
  `VEHICULO_ID_VEHICULO` INT NOT NULL,
  `TIPO_ESTADO_ID_TIPO_ESTADO` INT NOT NULL,
  `DESCUENTOS_ID_DESCUENTOS` INT NOT NULL COMMENT 'EL DESCUENTO QUE AFECTA EL PRECIO DE LA FACTURA ',
  PRIMARY KEY (`ID_FACTURA`, `VEHICULO_ID_VEHICULO`, `TIPO_ESTADO_ID_TIPO_ESTADO`, `DESCUENTOS_ID_DESCUENTOS`),
  INDEX `fk_FACTURA_VEHICULO1_idx` (`VEHICULO_ID_VEHICULO` ASC) VISIBLE,
  INDEX `fk_FACTURA_CLIENTE1_idx` (`CLIENTE_ID_CLIENTE` ASC) VISIBLE,
  INDEX `fk_FACTURA_TIPO_ESTADO1_idx` (`TIPO_ESTADO_ID_TIPO_ESTADO` ASC) VISIBLE,
  INDEX `fk_FACTURA_DESCUENTOS1_idx` (`DESCUENTOS_ID_DESCUENTOS` ASC) VISIBLE,
  CONSTRAINT `fk_FACTURA_VEHICULO1`
    FOREIGN KEY (`VEHICULO_ID_VEHICULO`)
    REFERENCES `cuci-mobil`.`VEHICULO` (`ID_VEHICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_FACTURA_CLIENTE1`
    FOREIGN KEY (`CLIENTE_ID_CLIENTE`)
    REFERENCES `cuci-mobil`.`CLIENTE` (`ID_CLIENTE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_FACTURA_TIPO_ESTADO1`
    FOREIGN KEY (`TIPO_ESTADO_ID_TIPO_ESTADO`)
    REFERENCES `cuci-mobil`.`TIPO_ESTADO` (`ID_TIPO_ESTADO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_FACTURA_DESCUENTOS1`
    FOREIGN KEY (`DESCUENTOS_ID_DESCUENTOS`)
    REFERENCES `cuci-mobil`.`DESCUENTOS` (`ID_DESCUENTOS`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`SERVICIOS_VEHICULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`SERVICIOS_VEHICULO` (
  `ID_SERVICIOS_VEHICULO` INT NOT NULL AUTO_INCREMENT COMMENT 'Identificador de del servicio que tiene cada vehiculo',
  `VALOR` DECIMAL(15,3) NOT NULL COMMENT 'el valor que tendra al momento de prestar este servicio ',
  `SERVICIOS_ID_SERVICIO` INT NOT NULL COMMENT 'el id del servicio el cual tiene el mobre del servicio',
  `TIPO_VEHICULO_ID_TIPO_VEHICULO` INT NOT NULL COMMENT 'el id del tipo de vehicula acual se le prestara el servicio',
  `TIPO_ESTADO_ID_TIPO_ESTADO` INT NOT NULL COMMENT 'el id del estado del servicio',
  PRIMARY KEY (`ID_SERVICIOS_VEHICULO`, `SERVICIOS_ID_SERVICIO`, `TIPO_VEHICULO_ID_TIPO_VEHICULO`, `TIPO_ESTADO_ID_TIPO_ESTADO`),
  INDEX `fk_SERVICIOS_VEHICULO_SERVICIOS1_idx` (`SERVICIOS_ID_SERVICIO` ASC) VISIBLE,
  INDEX `fk_SERVICIOS_VEHICULO_TIPO_VEHICULO1_idx` (`TIPO_VEHICULO_ID_TIPO_VEHICULO` ASC) VISIBLE,
  INDEX `fk_SERVICIOS_VEHICULO_TIPO_ESTADO1_idx` (`TIPO_ESTADO_ID_TIPO_ESTADO` ASC) VISIBLE,
  CONSTRAINT `fk_SERVICIOS_VEHICULO_SERVICIOS1`
    FOREIGN KEY (`SERVICIOS_ID_SERVICIO`)
    REFERENCES `cuci-mobil`.`SERVICIOS` (`ID_SERVICIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SERVICIOS_VEHICULO_TIPO_VEHICULO1`
    FOREIGN KEY (`TIPO_VEHICULO_ID_TIPO_VEHICULO`)
    REFERENCES `cuci-mobil`.`TIPO_VEHICULO` (`ID_TIPO_VEHICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SERVICIOS_VEHICULO_TIPO_ESTADO1`
    FOREIGN KEY (`TIPO_ESTADO_ID_TIPO_ESTADO`)
    REFERENCES `cuci-mobil`.`TIPO_ESTADO` (`ID_TIPO_ESTADO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`DETALLE_FACTURA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`DETALLE_FACTURA` (
  `ID_DETALLE_FACTURA` INT NOT NULL AUTO_INCREMENT COMMENT 'id del detalle factura ',
  `SERVICIOS_VEHICULO_ID_SERVICIOS_VEHICULO` INT NOT NULL COMMENT 'id de los servicios que se le prestaran al vehiculo',
  `FACTURA_ID_FACTURA` INT NOT NULL COMMENT 'id de la factura para en listar los detalles de la factura ',
  PRIMARY KEY (`ID_DETALLE_FACTURA`, `SERVICIOS_VEHICULO_ID_SERVICIOS_VEHICULO`, `FACTURA_ID_FACTURA`),
  INDEX `fk_DETALLE_FACTURA_SERVICIOS_VEHICULO1_idx` (`SERVICIOS_VEHICULO_ID_SERVICIOS_VEHICULO` ASC) VISIBLE,
  INDEX `fk_DETALLE_FACTURA_FACTURA1_idx` (`FACTURA_ID_FACTURA` ASC) VISIBLE,
  CONSTRAINT `fk_DETALLE_FACTURA_SERVICIOS_VEHICULO1`
    FOREIGN KEY (`SERVICIOS_VEHICULO_ID_SERVICIOS_VEHICULO`)
    REFERENCES `cuci-mobil`.`SERVICIOS_VEHICULO` (`ID_SERVICIOS_VEHICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_DETALLE_FACTURA_FACTURA1`
    FOREIGN KEY (`FACTURA_ID_FACTURA`)
    REFERENCES `cuci-mobil`.`FACTURA` (`ID_FACTURA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`CLIENTE_VEHICULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`CLIENTE_VEHICULO` (
  `ID_CLIENTE_VEHICULO` INT NOT NULL AUTO_INCREMENT COMMENT 'id de la relacion del cliente y el vehiculo',
  `VEHICULO_ID_VEHICULO` INT NOT NULL COMMENT 'id del vehiculo',
  `VEHICULO_TIPO_VEHICULO_ID_TIPO_VEHICULO` INT NOT NULL COMMENT 'id del tipo de vehiculo ',
  `CLIENTE_ID_CLIENTE` INT NOT NULL COMMENT 'id del cliente dueño del vehiculo',
  PRIMARY KEY (`ID_CLIENTE_VEHICULO`, `VEHICULO_ID_VEHICULO`, `VEHICULO_TIPO_VEHICULO_ID_TIPO_VEHICULO`, `CLIENTE_ID_CLIENTE`),
  INDEX `fk_CLIENTE_VEHICULO_VEHICULO1_idx` (`VEHICULO_ID_VEHICULO` ASC, `VEHICULO_TIPO_VEHICULO_ID_TIPO_VEHICULO` ASC) VISIBLE,
  INDEX `fk_CLIENTE_VEHICULO_CLIENTE1_idx` (`CLIENTE_ID_CLIENTE` ASC) VISIBLE,
  CONSTRAINT `fk_CLIENTE_VEHICULO_VEHICULO1`
    FOREIGN KEY (`VEHICULO_ID_VEHICULO` , `VEHICULO_TIPO_VEHICULO_ID_TIPO_VEHICULO`)
    REFERENCES `cuci-mobil`.`VEHICULO` (`ID_VEHICULO` , `TIPO_VEHICULO_ID_TIPO_VEHICULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CLIENTE_VEHICULO_CLIENTE1`
    FOREIGN KEY (`CLIENTE_ID_CLIENTE`)
    REFERENCES `cuci-mobil`.`CLIENTE` (`ID_CLIENTE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cuci-mobil`.`AUDITORIA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cuci-mobil`.`AUDITORIA` (
  `ID_AUDITORIA` INT NOT NULL AUTO_INCREMENT,
  `MENSAJE` TINYTEXT NOT NULL COMMENT 'LOG DE LA AUDITORIA/ INFORMACION INPORTANTE ',
  `FECHA` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'FECHA EN QUE SE REALIZO ESTA AUDITORIA ',
  `TABLAS_AFECTADA` VARCHAR(45) NOT NULL COMMENT 'LAS TABLAS LAS CUALES FUE FERON AFECTADAS POR LA CONSULTAS TALES COMO SELECT , UPDATE, INSERT O DELETE ',
  `CONSULTA` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID_AUDITORIA`))
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
